<?xml version="1.0"?>
<AlteryxDocument yxmdVer="2022.1">
  <Nodes>
    <Node ToolID="6">
      <GuiSettings Plugin="AlteryxGuiToolkit.Questions.Tab.Tab">
        <Position x="0" y="0" width="59" height="59" />
      </GuiSettings>
      <Properties>
        <Configuration />
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="64">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="54" y="54" width="962" height="378" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Iterative Macro</Caption>
          <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="34">
          <GuiSettings Plugin="AlteryxBasePluginsGui.MacroInput.MacroInput">
            <Position x="165" y="151" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <UseFileInput value="False" />
              <Name>Input Data</Name>
              <Abbrev>D</Abbrev>
              <ShowFieldMap value="True" />
              <Optional value="False" />
              <TextInput>
                <Configuration>
                  <NumRows value="6" />
                  <Fields>
                    <Field name="Number" />
                  </Fields>
                  <Data>
                    <r>
                      <c>1</c>
                    </r>
                    <r>
                      <c>8</c>
                    </r>
                    <r>
                      <c>6</c>
                    </r>
                    <r>
                      <c>4</c>
                    </r>
                    <r>
                      <c>2</c>
                    </r>
                    <r>
                      <c>12</c>
                    </r>
                  </Data>
                </Configuration>
              </TextInput>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Data Input and Iteration input</AnnotationText>
              <DefaultAnnotationText>Data Input and Iteration input
D Input</DefaultAnnotationText>
              <Left value="True" />
            </Annotation>
            <MetaInfo connection="Output">
              <RecordInfo>
                <Field name="Number" source="TextInput:" type="Byte" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxMacroInput" />
        </Node>
        <Node ToolID="42">
          <GuiSettings Plugin="AlteryxBasePluginsGui.MacroOutput.MacroOutput">
            <Position x="838" y="103" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Name>Factorial</Name>
              <Abbrev>F</Abbrev>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Factorial Output</AnnotationText>
              <DefaultAnnotationText>Factorial Output
F Output</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxMacroOutput" />
        </Node>
        <Node ToolID="43">
          <GuiSettings Plugin="AlteryxBasePluginsGui.MacroOutput.MacroOutput">
            <Position x="838" y="224" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Name>Iterate</Name>
              <Abbrev>I</Abbrev>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Iteration Output</AnnotationText>
              <DefaultAnnotationText>Iteration Output
I Output</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxMacroOutput" />
        </Node>
        <Node ToolID="49">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
            <Position x="526" y="152" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <FormulaFields>
                <FormulaField expression="/*Allow for the first iteration:*/&#xA;&#xA;if [Engine.IterationNumber]=0 then 1 &#xA;&#xA;/*Multiplication step per iteration for the factorial:*/&#xA;&#xA;else [Factorial]*([Engine.IterationNumber]+1) &#xA;&#xA;endif&#xA;" field="Factorial" size="8" type="Int64" />
              </FormulaFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Formula sets the factorial number on each pass, starting with 1, then 1x2=2, 2x3=6 etc.</AnnotationText>
              <DefaultAnnotationText>Factorial = /*Allow for the first iteration:*/

if [Engine.IterationNumber]=0 th...</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="Output">
              <RecordInfo>
                <Field name="Number" source="TextInput:" type="Byte" />
                <Field name="Factorial" source="Formula: /*Allow for the first iteration:*/&#xA;&#xA;if [Engine.IterationNumber]=0 then 1 &#xA;&#xA;/*Multiplication step per iteration for the factorial:*/&#xA;&#xA;else [Factorial]*([Engine.IterationNumber]+1) &#xA;&#xA;endif&#xA;" type="Int64" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
        </Node>
        <Node ToolID="53">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Filter.Filter">
            <Position x="658" y="152" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Expression>[Engine.IterationNumber]+1=[Number]</Expression>
              <Mode>Custom</Mode>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText><![CDATA[Filters out rows when the [Iteration.Number]+1=Number. ]]></AnnotationText>
              <DefaultAnnotationText>[Engine.IterationNumber]+1=[Number]</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="True">
              <RecordInfo>
                <Field name="Number" source="TextInput:" type="Byte" />
                <Field name="Factorial" source="Formula: /*Allow for the first iteration:*/&#xA;&#xA;if [Engine.IterationNumber]=0 then 1 &#xA;&#xA;/*Multiplication step per iteration for the factorial:*/&#xA;&#xA;else [Factorial]*([Engine.IterationNumber]+1) &#xA;&#xA;endif&#xA;" type="Int64" />
              </RecordInfo>
            </MetaInfo>
            <MetaInfo connection="False">
              <RecordInfo>
                <Field name="Number" source="TextInput:" type="Byte" />
                <Field name="Factorial" source="Formula: /*Allow for the first iteration:*/&#xA;&#xA;if [Engine.IterationNumber]=0 then 1 &#xA;&#xA;/*Multiplication step per iteration for the factorial:*/&#xA;&#xA;else [Factorial]*([Engine.IterationNumber]+1) &#xA;&#xA;endif&#xA;" type="Int64" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFilter" />
        </Node>
        <Node ToolID="60">
          <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
            <Position x="165" y="247" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <NumRows value="0" />
              <Fields>
                <Field name="Factorial" />
              </Fields>
              <Data />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Text input adds the Factorial field for the first pass with no values</AnnotationText>
              <DefaultAnnotationText>Text input adds the Factorial field for the first pass with no values</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="Output">
              <RecordInfo>
                <Field name="Factorial" size="1073741823" source="TextInput:" type="V_WString" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
        </Node>
        <Node ToolID="61">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Union.Union">
            <Position x="394" y="151" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <ByName_ErrorMode>Ignore</ByName_ErrorMode>
              <ByName_OutputMode>All</ByName_OutputMode>
              <Mode>ByName</Mode>
              <SetOutputOrder value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Must be set to config by name, ignore warnings and output all fields. This way the text input inserts the Factorial field on the first iteration, then merges with the existing field on subsequent iterations</AnnotationText>
              <DefaultAnnotationText>Must be set to config by name, ignore warnings and output all fields. This way the text input inserts the Factorial field on the first iteration, then merges with the existing field on subsequent iterations</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="Output">
              <RecordInfo>
                <Field name="Number" source="TextInput:" type="Byte" />
                <Field name="Factorial" source="TextInput:" type="Int64" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnion" />
        </Node>
        <Node ToolID="62">
          <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
            <Position x="274" y="248" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <OrderChanged value="False" />
              <CommaDecimal value="False" />
              <SelectFields>
                <SelectField field="Factorial" selected="True" type="Int64" size="8" />
                <SelectField field="*Unknown" selected="True" />
              </SelectFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Change Factorial to a INT64 field to match with subsequent iterations</AnnotationText>
              <DefaultAnnotationText>Change Factorial to a INT64 field to match with subsequent iterations</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="Output">
              <RecordInfo>
                <Field name="Factorial" source="TextInput:" type="Int64" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
        </Node>
        <Node ToolID="63">
          <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
            <Position x="646" y="296" width="108" height="48" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Text><![CDATA[Remember that the Iteration Number is base 0. ]]></Text>
              <Font name="Arial" size="8.25" style="0" />
              <TextColor name="Black" />
              <FillColor r="255" g="255" b="128" />
              <Shape shape="0" />
              <Justification Justification="3" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
        </Node>
      </ChildNodes>
    </Node>
  </Nodes>
  <Connections>
    <Connection name="#1">
      <Origin ToolID="34" Connection="Output" />
      <Destination ToolID="61" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="62" Connection="Output" />
      <Destination ToolID="61" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="49" Connection="Output" />
      <Destination ToolID="53" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="53" Connection="True" />
      <Destination ToolID="42" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="53" Connection="False" />
      <Destination ToolID="43" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="60" Connection="Output" />
      <Destination ToolID="62" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="61" Connection="Output" />
      <Destination ToolID="49" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <PredictiveToolsCodePage value="1252" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="False" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <Constants>
      <Constant>
        <Namespace>Question</Namespace>
        <Name>Macro Input (34)</Name>
        <Value />
        <IsNumeric value="False" />
      </Constant>
      <Constant>
        <Namespace>Question</Namespace>
        <Name>Macro Output (42)</Name>
        <Value />
        <IsNumeric value="False" />
      </Constant>
      <Constant>
        <Namespace>Question</Namespace>
        <Name>Macro Output (43)</Name>
        <Value />
        <IsNumeric value="False" />
      </Constant>
    </Constants>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>MacroFactorial Iterative4</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
      <WorkflowId value="3a4b871a-834d-48a3-b063-fb63a42c4ce2" />
      <Telemetry>
        <PreviousWorkflowId value="4655e671-89dc-48b5-acc5-ae1e74069568" />
        <OriginWorkflowId value="edd66b06-d685-44d1-941f-fac5bb82acd6" />
      </Telemetry>
    </MetaInfo>
    <Events>
      <Enabled value="False" />
    </Events>
    <RuntimeProperties>
      <Actions />
      <Questions>
        <Question>
          <Type>Tab</Type>
          <Description>Questions</Description>
          <Name>Onglet (6)</Name>
          <ToolId value="6" />
          <Questions>
            <Question>
              <Type>MacroInput</Type>
              <Description>Macro Input (34)</Description>
              <Name>Macro Input (34)</Name>
              <ToolId value="34" />
            </Question>
            <Question>
              <Type>MacroOutput</Type>
              <Description>Macro Output (42)</Description>
              <Name>Macro Output (42)</Name>
              <ToolId value="42" />
            </Question>
            <Question>
              <Type>MacroOutput</Type>
              <Description>Macro Output (43)</Description>
              <Name>Macro Output (43)</Name>
              <ToolId value="43" />
            </Question>
          </Questions>
        </Question>
      </Questions>
      <ModuleType>Macro</ModuleType>
      <MacroCustomHelp value="False" />
      <MacroDynamicOutputFields value="False" />
      <MacroImageStd value="20" />
      <MacroInputs />
      <MacroOutputs />
      <IterativeMacro>
        <Input>Input Data</Input>
        <Output>Iterate</Output>
        <IterationLimit value="1000" />
        <LimitBehavior>Warn</LimitBehavior>
        <OutputMode>AllSame</OutputMode>
      </IterativeMacro>
      <Wiz_CustomHelp value="False" />
      <Wiz_CustomGraphic value="False" />
      <Wiz_ShowOutput value="True" />
      <Wiz_OpenOutputTools>
        <Tool ToolId="34" Selected="True" />
        <Tool ToolId="42" Selected="True" />
        <Tool ToolId="43" Selected="True" />
      </Wiz_OpenOutputTools>
      <Wiz_OutputMessage />
      <Wiz_NoOutputFilesMessage />
      <Wiz_ChainRunWizard />
    </RuntimeProperties>
  </Properties>
</AlteryxDocument>